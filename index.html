<!DOCTYPE html>
<html>

<head>
    <title>Fullscreen Page</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <!-- Reference on how to include link for css: https://www.w3schools.com/css/css_howto.asp -->
    <link rel="stylesheet" href="./css/myStyles.css">
</head>

<body>
    <div id="customModal">
        <p>Are you sure you want to close this window?</p>
        <button onclick="closeModalAndWindow(true)">Yes</button>
        <button onclick="closeModalAndWindow(false)">No</button>
    </div>

    <h2 id="b1Display"></h2>

    <input type="text" id="userInput" placeholder="Enter text">
    <button onclick="sendData()">Submit</button>
    <button id="close-button" onclick="closeWindow()">X</button>
    <div id="app-container">
        <nav class="navbar">
            <ul>
                <li><a id="review" onmouseover="SetOnMouseOver('Review')">Review</a></li>
                <li><a id="publish" onmouseover="SetOnMouseOver('Publish')">Publish</a></li>
                <li><a id="universe" onmouseover="SetOnMouseOver('Universe')">Universe</a></li>
                <li><a id="reject" onmouseover="SetOnMouseOver('Reject')">Reject</a></li>
                <li class="dropdown">
                    <a id="move" href="javascript:void(0)" class="dropbtn" onmouseover="SetOnMouseOver('Move')">Move</a>
                    <div class="dropdown-content">
                        <a href="#" onclick="sendData('MOVE','Form Reponses 1'); return false">Form Responses</a>
                        <a href="#" onclick="sendData('MOVE','Master Submissions'); return false">Master
                            Submissions</a>
                        <a href="#" onclick="sendData('MOVE','Publish'); return false">Publish</a>
                        <a href="#" onclick="sendData('MOVE','Universe'); return false">Universe</a>
                        <a href="#" onclick="sendData('MOVE','Reject'); return false">Reject</a>
                        <a href="#" onclick="sendData('MOVE','Finished'); return false">Finished</a>
                        <a href="#" onclick="sendData('MOVE','Archive'); return false">Archive</a>
                    </div>
                </li>
                <li class="delete"><a id="delete" href="#" onclick="sendData('DELETE'); return false"
                        onmouseover="SetOnMouseOver('Delete')">Delete</a></li>
            </ul>
        </nav>

        <div id="mainContainer" onmouseenter="SetOnMouseEnterBody()">
            <div id="reviewBody">
                <h3 id="b1SubmissionHeader"></h3>
                <h3 id="c1SubmissionHeader"></h3>
                <h3 id="d1SubmissionHeader"></h3>
                <h3>Submission Date</h3>
                <div id="colB_Data"></div>
                <h3 id="e1SubmissionHeader"></h3>
                <div id="colE_Data"></div>
                <h3 id="f1SubmissionHeader"></h3>
                <div id="colF_Data"></div>
                <h3 id="j1SubmissionHeader"></h3>
                <div id="colJ_Data">
                    <iframe frameborder='0' height='55' width='100%' src=''>></iframe>
                </div>
                <h3 id="k1SubmissionHeader"></h3>
                <div id="colK_Data">
                    <iframe frameborder='0' height='1000' width='100%' src=''>></iframe>
                </div>
                <h3 id="i1SubmissionHeader"></h3>
                <div id="colI_Data">
                    <iframe frameborder='0' height='300' width='100%' src=''>></iframe>
                </div>
                <h3 id="m1SubmissionHeader"></h3>
                <div id="colM_Data">
                    <iframe frameborder="0" allowfullscreen="" style="width:100%;
                        height:400px;" src=''></iframe>
                </div>
                <h3 id="g1SubmissionHeader"></h3>
                <div id="colG_Data"></div>
                <h3 id="h1SubmissionHeader"></h3>
                <div id="colH_Data"></div>
                <h3 id="l1SubmissionHeader"></h3>
                <div id="colL_Data"></div>
                <h3 id="n1SubmissionHeader"></h3>
                <div id="colN_Data"></div>
                <h3 id="o1SubmissionHeader"></h3>
                <div id="colO_Data"></div>
                <h3 id="p1SubmissionHeader"></h3>
                <div id="colP_Data"></div>
                <h3 id="q1SubmissionHeader"></h3>
                <div id="colQ_Data"></div>
            </div>

            <div id="publishUniverseOrRejectBody" class="publishUniverseReject">
                <input type="text" id="emailSubject">
                <input type="hidden" id="publishEmailSubject">
                <input type="hidden" id="publishEmailSubjectAlternative">
                <input type="hidden" id="universeEmailSubject">
                <input type="hidden" id="universeEmailSubjectAlternative">
                <input type="hidden" id="rejectEmailSubject">
                <input type="hidden" id="rejectEmailSubjectAlternative">
                <input type="hidden" id="universeEmailSubjectAlternative">
                <input type="hidden" id="publishEmailBody">
                <input type="hidden" id="publishEmailBodyAlternative">
                <input type="hidden" id="universeEmailBody">
                <input type="hidden" id="universeEmailBodyAlternative">
                <input type="hidden" id="rejectEmailBody">
                <input type="hidden" id="rejectEmailBodyAlternative">
                <input type="hidden" id="responseSheetName">
                <input type="hidden" id="responseRow">
                <input type="hidden" id="emailSubjectAltenative">
                <input type="hidden" id="emailBodyAltenative">
                <input type="hidden" id="webAppUrl">
                <br><br>
                <textarea id="emailBody"></textarea>
                <div class="containerForButtons">
                    <!-- SEND EMAIL -->
                    <button id="sendButtonPublish"
                        onclick="sendData('SEND','Publish',emailSubject.value, emailBody.value)">Send</button>
                    <button id="sendButtonUniverse"
                        onclick="sendData('SEND','Universe',emailSubject.value, emailBody.value)">Send</button>
                    <button id="sendButtonReject"
                        onclick="sendData('SEND','Reject',emailSubject.value, emailBody.value)">Send</button>
                    <!-- CHOOSE ORIGINAL OR ALTERNATIVE EMAIL TEMPLATE -->
                    <button id="alternativeButtonPublish" onclick="SeeAlternativeEmail('Publish')">Alternative</button>
                    <button id="alternativeButtonUniverse"
                        onclick="SeeAlternativeEmail('Universe')">Alternative</button>
                    <button id="alternativeButtonReject" onclick="SeeAlternativeEmail('Reject')">Alternative</button>
                    <!-- OPEN EMAIL TEMPLATE -->
                    <button id="emailTemplatePublishOriginalButton"
                        onclick="sendData('TEMPLATE','B1:C1','E:J','N/A','A18:J33')">Email Template</button>
                    <button id="emailTemplatePublishAlternativeButton"
                        onclick="sendData('TEMPLATE','B17:C17','E:J','N/A','A1:J16')">Email Template</button>
                    <button id="emailTemplateUniverseOriginalButton"
                        onclick="sendData('TEMPLATE','E1:F1','A:C','H:J','A18:J33')">Email Template</button>
                    <button id="emailTemplateUniverseAlternativeButton"
                        onclick="sendData('TEMPLATE','E17:F17','A:C','H:J','A1:J16')">Email Template</button>
                    <button id="emailTemplateRejectOriginalButton"
                        onclick="sendData('TEMPLATE','H1:I1','A:F','N/A','A18:J33')">Email Template</button>
                    <button id="emailTemplateRejectAlternativeButton"
                        onclick="sendData('TEMPLATE','H17:I17','A:F','N/A','A1:J16')">Email Template</button>
                    <!-- CANCEL, CLOSE WINDOW, AND OPEN CONFIRMATION MODAL DIALOG BOX -->
                    <button id="cancelButton" onclick="closeWindow()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Declare variables in the global scope
        let reviewBody = document.getElementById('reviewBody');
        let publishUniverseOrRejectBody = document.getElementById('publishUniverseOrRejectBody');
        let bodyElement = document.getElementById('mainContainer');
        let buttonElement = document.querySelectorAll("button");
        let emailSubject = document.getElementById('emailSubject');
        let emailBody = document.getElementById('emailBody');
        let emailSubjectAlternative = document.getElementById('emailSubjectAltenative');
        let emailBodyAlternative = document.getElementById('emailBodyAltenative');
        let publishUniverseOrReject = document.getElementById('publishUniverseOrReject');
        let sendButtonPublish = document.getElementById('sendButtonPublish');
        let alternativeButtonPublish = document.getElementById('alternativeButtonPublish');
        let emailTemplatePublishOriginalButton = document.getElementById('emailTemplatePublishOriginalButton');
        let emailTemplatePublishAlternativeButton = document.getElementById('emailTemplatePublishAlternativeButton');
        let sendButtonUniverse = document.getElementById('sendButtonUniverse');
        let alternativeButtonUniverse = document.getElementById('alternativeButtonUniverse');
        let emailTemplateUniverseOriginalButton = document.getElementById('emailTemplateUniverseOriginalButton');
        let emailTemplateUniverseAlternativeButton = document.getElementById('emailTemplateUniverseAlternativeButton');
        let sendButtonReject = document.getElementById('sendButtonReject');
        let alternativeButtonReject = document.getElementById('alternativeButtonReject');
        let emailTemplateRejectOriginalButton = document.getElementById('emailTemplateRejectOriginalButton');
        let emailTemplateRejectAlternativeButton = document.getElementById('emailTemplateRejectAlternativeButton');
        let review = document.getElementById('review');
        let publish = document.getElementById('publish');
        let universe = document.getElementById('universe');
        let reject = document.getElementById('reject');
        let root = document.documentElement;
        let navButtonHoverBackgroundColor = getComputedStyle(root).getPropertyValue('--navButtonHoverBackgroundColor');
        let navButtonHoverColor = getComputedStyle(root).getPropertyValue('--navButtonHoverColor');
        let bodyBackgroundColorReview = getComputedStyle(root).getPropertyValue('--bodyBackgroundColorReview');
        let bodyBackgroundColorPublish = getComputedStyle(root).getPropertyValue('--bodyBackgroundColorPublish');
        let bodyBackgroundColorUniverse = getComputedStyle(root).getPropertyValue('--bodyBackgroundColorUniverse');
        let bodyBackgroundColorReject = getComputedStyle(root).getPropertyValue('--bodyBackgroundColorReject');
        let buttonBackgroundColorReview = getComputedStyle(root).getPropertyValue('--buttonBackgroundColorReview');
        let buttonBackgroundColorPublish = getComputedStyle(root).getPropertyValue('--buttonBackgroundColorPublish');
        let buttonBackgroundColorUniverse = getComputedStyle(root).getPropertyValue('--buttonBackgroundColorUniverse');
        let buttonBackgroundColorReject = getComputedStyle(root).getPropertyValue('--buttonBackgroundColorReject');
        let mainContainer = document.getElementById('mainContainer');

        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            const returnValue = results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
            console.log("getUrlParameter(" + name + "): ", returnValue);
            return returnValue;
        }

        function fetchData() {
            const url = new URL(window.location.href);
            const googleScriptUrl = url.searchParams.get('googleScriptUrl');
            console.log(googleScriptUrl);
            if (googleScriptUrl) {
                fetch(googleScriptUrl)
                    .then(response => response.json())
                    .then(data => {
                        console.log("Data from Apps Script:", data);

                        if (data && data.b1ToQ1SubmissionHeaders) {
                            const values = data.b1ToQ1SubmissionHeaders;
                            document.getElementById("b1SubmissionHeader").innerHTML = values[0];
                            document.getElementById("c1SubmissionHeader").innerHTML = values[1];
                            document.getElementById("d1SubmissionHeader").innerHTML = values[2];
                            document.getElementById("e1SubmissionHeader").innerHTML = values[3];
                            document.getElementById("f1SubmissionHeader").innerHTML = values[4];
                            document.getElementById("g1SubmissionHeader").innerHTML = values[5];
                            document.getElementById("h1SubmissionHeader").innerHTML = values[6];
                            document.getElementById("i1SubmissionHeader").innerHTML = values[7];
                            document.getElementById("j1SubmissionHeader").innerHTML = values[8];
                            document.getElementById("k1SubmissionHeader").innerHTML = values[9];
                            document.getElementById("l1SubmissionHeader").innerHTML = values[10];
                            document.getElementById("m1SubmissionHeader").innerHTML = values[11];
                            document.getElementById("n1SubmissionHeader").innerHTML = values[12];
                            document.getElementById("o1SubmissionHeader").innerHTML = values[13];
                            document.getElementById("p1SubmissionHeader").innerHTML = values[14];
                            document.getElementById("q1SubmissionHeader").innerHTML = values[15];
                        } else {
                            console.error("B1:Q1 Submission Headers are null or undefined");
                        }

                        if (data && data.b1Value) {
                            document.getElementById("b1Display").innerHTML = data.b1Value;
                        } else {
                            console.error("Test!B1 value is null or undefined");
                        }
                    })
                    .catch(error => {
                        console.error("Error fetching data:", error);
                    });
            }
        }

        fetchData(); // Call fetchData immediately

        function getGoogleData() {
            const url = new URL(window.location.href);
            const googleScriptUrl = url.searchParams.get('googleScriptUrl');
            if (googleScriptUrl) {
                fetch(googleScriptUrl)
                    .then(response => response.text());
            }
        }

        getGoogleData(); // Call getGoogleData immediately

        // function closeWindow() {
        //     window.close();
        // }

        function showCustomModal() {
            console.log("showCustomModal() called"); // Add this line
            document.getElementById('customModal').style.display = 'block';
        }

        function closeModalAndWindow(closeWindow) {
            console.log("closeModalAndWindow() called with closeWindow:", closeWindow); // Add this line
            document.getElementById('customModal').style.display = 'none';
            if (closeWindow) {
                window.close();
            }
        }

        function closeWindow() {
            window.close();
        }

        function sendData(action = undefined, dataToBeSent1 = undefined, dataToBeSent2 = undefined, dataToBeSent3 = undefined, dataToBeSent4 = undefined) {
            const userInput = document.getElementById('userInput').value;
            const url = new URL(window.location.href);
            const googleScriptUrl = url.searchParams.get('googleScriptUrl');

            if (action == "TEMPLATE") {
                if (googleScriptUrl) {
                    let sheetName = "Email Templates";
                    fetch(googleScriptUrl + "?sheetName=" + encodeURIComponent(sheetName))
                        .then(response => response.text())
                        .then(url => {
                            window.open(url, "_self");
                        });
                } else {
                    alert("Google Script URL not found.");
                }
            }

            if (googleScriptUrl) {
                let urlParams = `userInput=${encodeURIComponent(userInput)}`; // userInput will always be sent, even if empty

                if (action !== undefined) {
                    urlParams += `&action=${encodeURIComponent(action)}`;
                }
                if (dataToBeSent1 !== undefined) {
                    urlParams += `&dataToBeSent1=${encodeURIComponent(dataToBeSent1)}`;
                }
                if (dataToBeSent2 !== undefined) {
                    urlParams += `&dataToBeSent2=${encodeURIComponent(dataToBeSent2)}`;
                }
                if (dataToBeSent3 !== undefined) {
                    urlParams += `&dataToBeSent3=${encodeURIComponent(dataToBeSent3)}`;
                }
                if (dataToBeSent4 !== undefined) {
                    urlParams += `&dataToBeSent4=${encodeURIComponent(dataToBeSent4)}`;
                }

                console.log(googleScriptUrl + "?" + urlParams); // Add this line!

                fetch(googleScriptUrl + "?" + urlParams)
                    .then(() => {
                        console.log("Data Sent:", urlParams);
                        fetchData();
                        //closeWindow(); // close window
                    })
                    .catch(error => {
                        console.error("Error sending data:", error);
                    });
            }
        }

        function SetOnMouseOver(reviewPublishUniverseRejectMoveOrDelete) {
            if (reviewPublishUniverseRejectMoveOrDelete == "Review") {
                reviewBody.style.display = 'block';
                publishUniverseOrRejectBody.style.display = 'none';
                bodyElement.style.backgroundColor = bodyBackgroundColorReview;

                review.style.backgroundColor = buttonBackgroundColorReview;
                review.style.color = "#000";
                publish.style.backgroundColor = "#333";
                publish.style.color = "#fff";
                universe.style.backgroundColor = "#333";
                universe.style.color = "#fff";
                reject.style.backgroundColor = "#333";
                reject.style.color = "#fff";
            }
            else if (reviewPublishUniverseRejectMoveOrDelete == "Publish") {
                reviewBody.style.display = 'none';
                publishUniverseOrRejectBody.style.display = 'block';
                bodyElement.style.backgroundColor = bodyBackgroundColorPublish;

                for (let i = 0; i < buttonElement.length; i++) {
                    buttonElement[i].style.backgroundColor = buttonBackgroundColorPublish;
                    buttonElement[i].style.color = "#fff";
                }

                emailSubject.value = document.getElementById('publishEmailSubject').value;;
                emailBody.value = document.getElementById('publishEmailBody').value;;
                alternativeButtonPublish.innerText = "Alternative";

                sendButtonPublish.style.display = 'inline-block';
                alternativeButtonPublish.style.display = 'inline-block';
                emailTemplatePublishOriginalButton.style.display = 'inline-block';
                emailTemplatePublishAlternativeButton.style.display = 'none';
                sendButtonUniverse.style.display = 'none';
                alternativeButtonUniverse.style.display = 'none';
                emailTemplateUniverseOriginalButton.style.display = 'none';
                emailTemplateUniverseAlternativeButton.style.display = 'none';
                sendButtonReject.style.display = 'none';
                alternativeButtonReject.style.display = 'none';
                emailTemplateRejectOriginalButton.style.display = 'none';
                emailTemplateRejectAlternativeButton.style.display = 'none';

                review.style.backgroundColor = "#333";
                review.style.color = "#fff";
                publish.style.backgroundColor = buttonBackgroundColorPublish;
                publish.style.color = "#fff";
                universe.style.backgroundColor = "#333";
                universe.style.color = "#fff";
                reject.style.backgroundColor = "#333";
                reject.style.color = "#fff";
            }
            else if (reviewPublishUniverseRejectMoveOrDelete == "Universe") {
                reviewBody.style.display = 'none';
                publishUniverseOrRejectBody.style.display = 'block';
                bodyElement.style.backgroundColor = bodyBackgroundColorUniverse;

                for (let i = 0; i < buttonElement.length; i++) {
                    buttonElement[i].style.backgroundColor = buttonBackgroundColorUniverse;
                    buttonElement[i].style.color = "#000";
                }

                emailSubject.value = document.getElementById('universeEmailSubject').value;;
                emailBody.value = document.getElementById('universeEmailBody').value;;

                sendButtonPublish.style.display = 'none';
                alternativeButtonPublish.style.display = 'none';
                emailTemplatePublishOriginalButton.style.display = 'none';
                emailTemplatePublishAlternativeButton.style.display = 'none';
                sendButtonUniverse.style.display = 'inline-block';
                alternativeButtonUniverse.style.display = 'inline-block';
                emailTemplateUniverseOriginalButton.style.display = 'inline-block';
                emailTemplateUniverseAlternativeButton.style.display = 'none';
                sendButtonReject.style.display = 'none';
                alternativeButtonReject.style.display = 'none';
                emailTemplateRejectOriginalButton.style.display = 'none';
                emailTemplateRejectAlternativeButton.style.display = 'none';

                review.style.backgroundColor = "#333";
                review.style.color = "#fff";
                publish.style.backgroundColor = "#333";
                publish.style.color = "#fff";
                universe.style.backgroundColor = buttonBackgroundColorUniverse;
                universe.style.color = navButtonHoverColor;
                reject.style.backgroundColor = "#333";
                reject.style.color = "#fff";
            }
            else if (reviewPublishUniverseRejectMoveOrDelete == "Reject") {
                reviewBody.style.display = 'none';
                publishUniverseOrRejectBody.style.display = 'block';
                bodyElement.style.backgroundColor = bodyBackgroundColorReject;

                for (let i = 0; i < buttonElement.length; i++) {
                    buttonElement[i].style.backgroundColor = buttonBackgroundColorReject;
                    buttonElement[i].style.color = "#fff";
                }

                emailSubject.value = document.getElementById('rejectEmailSubject').value;;
                emailBody.value = document.getElementById('rejectEmailBody').value;;

                sendButtonPublish.style.display = 'none';
                alternativeButtonPublish.style.display = 'none';
                emailTemplatePublishOriginalButton.style.display = 'none';
                emailTemplatePublishAlternativeButton.style.display = 'none';
                sendButtonUniverse.style.display = 'none';
                alternativeButtonUniverse.style.display = 'none';
                emailTemplateUniverseOriginalButton.style.display = 'none';
                emailTemplateUniverseAlternativeButton.style.display = 'none';
                sendButtonReject.style.display = 'inline-block';
                alternativeButtonReject.style.display = 'inline-block';
                emailTemplateRejectOriginalButton.style.display = 'inline-block';
                emailTemplateRejectAlternativeButton.style.display = 'none';

                review.style.backgroundColor = "#333";
                review.style.color = "#fff";
                publish.style.backgroundColor = "#333";
                publish.style.color = "#fff";
                universe.style.backgroundColor = "#333";
                universe.style.color = "#fff";
                reject.style.backgroundColor = buttonBackgroundColorReject;
                reject.style.color = "#fff";
            }
            else if (reviewPublishUniverseRejectMoveOrDelete == "Move" || reviewPublishUniverseRejectMoveOrDelete == "Delete") {
                review.style.backgroundColor = "#333";
                review.style.color = "#fff";
                publish.style.backgroundColor = "#333";
                publish.style.color = "#fff";
                universe.style.backgroundColor = "#333";
                universe.style.color = "#fff";
                reject.style.backgroundColor = "#333";
                reject.style.color = "#fff";
            }
        }

        function SetOnMouseEnterBody() {
            if (reviewBody.style.display == 'block') {
                bodyElement.style.backgroundColor = bodyBackgroundColorReview;
            }
            else if (publishUniverseOrRejectBody.style.display == 'block' && sendButtonPublish.style.display == 'inline-block') {
                bodyElement.style.backgroundColor = bodyBackgroundColorPublish;
            }
            else if (publishUniverseOrRejectBody.style.display == 'block' && sendButtonUniverse.style.display == 'inline-block') {
                bodyElement.style.backgroundColor = bodyBackgroundColorUniverse;
            }
            else if (publishUniverseOrRejectBody.style.display == 'block' && sendButtonReject.style.display == 'inline-block') {
                bodyElement.style.backgroundColor = bodyBackgroundColorReject;
            }
            else {
                bodyElement.style.backgroundColor = "#fff";
            }
        }

        function SeeAlternativeEmail(publishUniverseOrReject) {
            if (publishUniverseOrReject == 'Publish') {
                if (alternativeButtonPublish.innerText == 'Alternative') {
                    emailSubject.value = publishEmailSubjectAlternative.value;
                    emailBody.value = publishEmailBodyAlternative.value;
                    alternativeButtonPublish.innerText = 'Original';
                    emailTemplatePublishOriginalButton.style.display = 'none';
                    emailTemplatePublishAlternativeButton.style.display = 'inline-block';
                }
                else {
                    emailSubject.value = document.getElementById('publishEmailSubject').value;;
                    emailBody.value = document.getElementById('publishEmailBody').value;;
                    alternativeButtonPublish.innerText = 'Alternative';
                    emailTemplatePublishOriginalButton.style.display = 'inline-block';
                    emailTemplatePublishAlternativeButton.style.display = 'none';
                }
            }
            else if (publishUniverseOrReject == 'Universe') {
                if (alternativeButtonUniverse.innerText == 'Alternative') {
                    emailSubject.value = universeEmailSubjectAlternative.value;
                    emailBody.value = universeEmailBodyAlternative.value;
                    alternativeButtonUniverse.innerText = 'Original';
                    emailTemplateUniverseOriginalButton.style.display = 'none';
                    emailTemplateUniverseAlternativeButton.style.display = 'inline-block';
                }
                else {
                    emailSubject.value = document.getElementById('universeEmailSubject').value;;
                    emailBody.value = document.getElementById('universeEmailBody').value;;
                    alternativeButtonUniverse.innerText = 'Alternative';
                    emailTemplateUniverseOriginalButton.style.display = 'inline-block';
                    emailTemplateUniverseAlternativeButton.style.display = 'none';
                }
            }
            else if (publishUniverseOrReject == 'Reject') {
                if (alternativeButtonReject.innerText == 'Alternative') {
                    emailSubject.value = rejectEmailSubjectAlternative.value;
                    emailBody.value = rejectEmailBodyAlternative.value;
                    alternativeButtonReject.innerText = 'Original';
                    emailTemplateRejectOriginalButton.style.display = 'none';
                    emailTemplateRejectAlternativeButton.style.display = 'inline-block';
                }
                else {
                    emailSubject.value = document.getElementById('rejectEmailSubject').value;;
                    emailBody.value = document.getElementById('rejectEmailBody').value;;
                    alternativeButtonReject.innerText = 'Alternative';
                    emailTemplateRejectOriginalButton.style.display = 'inline-block';
                    emailTemplateRejectAlternativeButton.style.display = 'none';
                }
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            var dataParam = getUrlParameter('data');
            if (dataParam) {
                var data = JSON.parse(dataParam);
                var rowValues = data.rowValues;
                console.log(rowValues);

                // Fill the pre-defined divs with row data
                for (var i = 0; i < rowValues.length; i++) { // Index 0 is column B. Skip column A because that is the checkbox column.
                    div = document.getElementById(['colB_Data', 'colC_Data', 'colD_Data', 'colE_Data', 'colF_Data', 'colG_Data', 'colH_Data', 'colI_Data', 'colJ_Data', 'colK_Data', 'colL_Data', 'colM_Data', 'colN_Data', 'colO_Data', 'colP_Data', 'colQ_Data', 'colR_Data'][i]);

                    if (i == 0) {
                        // Reference: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/getDay
                        // Sunday - Saturday : 0 - 6
                        let dateInCell = new Date(rowValues[0]);
                        let dayNumber = dateInCell.getDay();
                        let month = dateInCell.toLocaleString('default', { month: 'short' });
                        let date = dateInCell.getDate();
                        let year = dateInCell.getFullYear();

                        if (dayNumber == 0) {
                            day = 'Sun';
                        }
                        else if (dayNumber == 1) {
                            day = 'Mon';
                        }
                        else if (dayNumber == 2) {
                            day = 'Tue';
                        }
                        else if (dayNumber == 3) {
                            day = 'Wed';
                        }
                        else if (dayNumber == 4) {
                            day = 'Thu';
                        }
                        else if (dayNumber == 5) {
                            day = 'Fri';
                        }
                        else if (dayNumber == 6) {
                            day = 'Sat';
                        }

                        let submissionDate = day + ' ' + month + ' ' + date + ', ' + year;
                        div.textContent = submissionDate;
                    }
                    // For data columns I, J, K, and M from spreadsheet, there will be an iframe.
                    // Hence 7, 8, 9, 11
                    else if (i == 7 || i == 8 || i == 9 || i == 11) {
                        if (div) {
                            div.querySelector('iframe').src = rowValues[i];
                        }
                        else {
                            document.getElementById('colJ_Data').querySelector('iframe').src = 'about:blank';
                        }
                    }
                    else if (div) {
                        div.textContent = rowValues[i];
                    }
                }
                var responseSheetName = data.responseSheetName;
                var responseRow = data.responseRow;
                var publishEmailSubject = data.publishEmailSubject;
                var publishEmailBody = data.publishEmailBody;
                var publishEmailSubjectAlternative = data.publishEmailSubjectAlternative;
                var publishEmailBodyAlternative = data.publishEmailBodyAlternative;
                var universeEmailSubject = data.universeEmailSubject;
                var universeEmailBody = data.universeEmailBody;
                var universeEmailSubjectAlternative = data.universeEmailSubjectAlternative;
                var universeEmailBodyAlternative = data.universeEmailBodyAlternative;
                var rejectEmailSubject = data.rejectEmailSubject;
                var rejectEmailBody = data.rejectEmailBody;
                var rejectEmailSubjectAlternative = data.rejectEmailSubjectAlternative;
                var rejectEmailBodyAlternative = data.rejectEmailBodyAlternative;
                console.log("responseSheetName: " + data.responseSheetName);
                console.log("responseRow: " + data.responseRow);
                console.log("publishEmailSubject: " + data.publishEmailSubject);
                console.log("publishEmailBody: " + data.publishEmailBody);
                console.log("publishEmailSubjectAlternative: " + data.publishEmailSubjectAlternative);
                console.log("publishEmailBodyAlternative: " + data.publishEmailBodyAlternative);
                console.log("universeEmailSubject: " + data.universeEmailSubject);
                console.log("universeEmailBody: " + data.universeEmailBody);
                console.log("universeEmailSubjectAlternative: " + data.universeEmailSubjectAlternative);
                console.log("universeEmailBodyAlternative: " + data.universeEmailBodyAlternative);
                console.log("rejectEmailSubject: " + data.rejectEmailSubject);
                console.log("rejectEmailBody: " + data.rejectEmailBody);
                console.log("rejectEmailSubjectAlternative: " + data.rejectEmailSubjectAlternative);
                console.log("rejectEmailBodyAlternative: " + data.rejectEmailBodyAlternative);
                document.getElementById('responseSheetName').value = responseSheetName;
                document.getElementById('responseRow').value = responseRow;
                document.getElementById('publishEmailSubject').value = publishEmailSubject;
                document.getElementById('publishEmailBody').value = publishEmailBody;
                document.getElementById('publishEmailSubjectAlternative').value = publishEmailSubjectAlternative;
                document.getElementById('publishEmailBodyAlternative').value = publishEmailBodyAlternative;
                document.getElementById('universeEmailSubject').value = universeEmailSubject;
                document.getElementById('universeEmailBody').value = universeEmailBody;
                document.getElementById('universeEmailSubjectAlternative').value = universeEmailSubjectAlternative;
                document.getElementById('universeEmailBodyAlternative').value = universeEmailBodyAlternative;
                document.getElementById('rejectEmailSubject').value = rejectEmailSubject;
                document.getElementById('rejectEmailBody').value = rejectEmailBody;
                document.getElementById('rejectEmailSubjectAlternative').value = rejectEmailSubjectAlternative;
                document.getElementById('rejectEmailBodyAlternative').value = rejectEmailBodyAlternative;
            }
        });
    </script>
</body>

</html>