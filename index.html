<!DOCTYPE html>
<html>

<head>
    <title>Fullscreen Page</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <style>
        /* Your existing styles... */
        body {
            margin: 0;
            padding: 0;
            overflow-y: scroll;
            background-color: black;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-size: 2em;
        }

        :root {
            --navButtonHoverBackgroundColor: #f9f9f9;
            --navButtonHoverColor: #000000;
            --navButtonHoverBorderColor: #333;
            --bodyBackgroundColorReview: #d3d3d3;
            --bodyBackgroundColorPublish: #90ee90;
            --bodyBackgroundColorUniverse: #ffffb3;
            --bodyBackgroundColorReject: #ffb3b3;
            --buttonBackgroundColorReview: #ffe6cc;
            --buttonBackgroundColorPublish: #00802b;
            --buttonBackgroundColorUniverse: #ffff00;
            --buttonBackgroundColorReject: #b30000;
        }

        .navbar {
            position: -webkit-sticky;
            position: sticky;
            top: 4px;
            z-index: 1;
            scrollbar-gutter: stable both-edges;
        }

        ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #333;
            display: flex;
            justify-content: flex-start;
            width: 100%;
            border: 1px solid #333;
            outline: 1px solid #333
        }

        li {
            float: left;
            width: 100%;
            display: flex;
            justify-content: flex-start;
        }

        li a,
        .dropbtn {
            display: inline-block;
            color: white;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
            border: 4px solid #333;
            outline: 1px solid #333;
        }

        li a {
            width: 11vw;
        }

        li a#review,
        li a#publish,
        li a#universe,
        li a#reject {
            border-top-left-radius: 12px;
            border-top-right-radius: 12px;
        }

        li a:hover,
        .dropdown:hover .dropbtn {
            background-color: var(--navButtonHoverBackgroundColor);
            color: var(--navButtonHoverColor);
            border: 4px solid var(--navButtonHoverBorderColor);
        }

        li.dropdown {
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            width: 200px;
            height: 390px;
            z-index: 1;
            top: 55px;
        }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            position: relative;
            top: -6px;
            right: 0;
            margin-top: 6px;
            text-align: left;
            width: 150px;
            border: 4px solid #f9f9f9;
            outline: 4px solid #333;
            font-weight: bold;
        }

        .dropdown-content a:hover {
            background-color: #d9d9d9;
            border: 4px solid #f9f9f9;
        }

        .dropdown:hover .dropdown-content {
            display: block;
            width: 190px;
            border: 4px solid #333;
        }

        div.publishUniverseReject {
            display: none;
        }

        div#reviewBody {
            margin-top: -20px;
        }

        div#reviewBody h3 {
            background-color: #ffe6cc;
            border: 1px solid #333;
            color: #000;
            border-top-left-radius: 6px;
            border-top-right-radius: 6px;
            padding: 10px;
            margin-bottom: 0;
        }

        div#reviewBody>div {
            background-color: #fff;
            padding: 10px;
            border: 1px solid #333;
            border-top-style: none;
        }

        button {
            border: 4px solid #404040;
            border-radius: 8px;
            padding: 15px 10px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            font-family: 'Roboto', sans-serif;
            width: 23.4%;
        }

        button:hover {
            border: 4px solid #fff;
            outline: 1px solid #000;
            border-radius: 8px;
        }

        input {
            font-size: 16px;
            padding: 5px 10px;
        }

        textarea {
            field-sizing: content;
            font-size: 16px;
            line-height: 25px;
            padding: 5px 10px;
        }

        div.containerForButtons {
            margin-top: 7px;
        }

        div.containerForButtons,
        input,
        textarea {
            width: 76%;
            margin-left: 10%;
            margin-right: 10%;
        }

        div.containerForButtons {
            width: 80%;
            margin-left: 10%;
            margin-right: 10%;
        }

        div#mainContainer {
            position: relative;
            left: 1px;
            background-color: lightgray;
            border: 5px solid #333;
            outline: 2px solid #333;
            border-top: none;
            padding: 20px;
            min-height: 460px;
        }
    </style>
</head>

<body>
    <h2 id="b1Display"></h2>

    <div id="rowDataContainer">
        <div id="colB_Data"></div>
        <div id="colC_Data"></div>
        <div id="colD_Data"></div>
        <div id="colE_Data"></div>
        <div id="colF_Data"></div>
    </div>

    <p id="displayArea"></p>
    <input type="text" id="userInput" placeholder="Enter text">
    <button onclick="sendInput()">Submit</button>
    <button onclick="closeWindow()">Close Window</button>
    <div id="app-container">
        <nav class="navbar">
            <ul>
                <li><a id="review" onmouseover="SetOnMouseOver('Review')">Review</a></li>
                <li><a id="publish" onmouseover="SetOnMouseOver('Publish')">Publish</a></li>
                <li><a id="universe" onmouseover="SetOnMouseOver('Universe')">Universe</a></li>
                <li><a id="reject" onmouseover="SetOnMouseOver('Reject')">Reject</a></li>
                <li class="dropdown">
                    <a id="move" href="javascript:void(0)" class="dropbtn" onmouseover="SetOnMouseOver('Move')">Move</a>
                    <div class="dropdown-content">
                        <a href="#" onclick="SendInfoToGsFile('Form Reponses 1'); return false">Form Responses</a>
                        <a href="#" onclick="SendInfoToGsFile('Master Submissions'); return false">Master
                            Submissions</a>
                        <a href="#" onclick="SendInfoToGsFile('Publish'); return false">Publish</a>
                        <a href="#" onclick="SendInfoToGsFile('Universe'); return false">Universe</a>
                        <a href="#" onclick="SendInfoToGsFile('Reject'); return false">Reject</a>
                        <a href="#" onclick="SendInfoToGsFile('Finished'); return false">Finished</a>
                        <a href="#" onclick="SendInfoToGsFile('Archive'); return false">Archive</a>
                    </div>
                </li>
                <li class="delete"><a id="delete" href="#" onclick="SendInfoForDelete(); return false"
                        onmouseover="SetOnMouseOver('Delete')">Delete</a></li>
            </ul>
        </nav>

        <div id="mainContainer" onmouseenter="SetOnMouseEnterBody()">
            <div id="reviewBody">
                <h3 id="b1SubmissionHeader"></h3>
                <h3 id="c1SubmissionHeader"></h3>
                <h3 id="d1SubmissionHeader"></h3>
                <h3>Submission Date</h3>
                <div>
                    <?= contentB ?>
                </div>
                <h3 id="e1SubmissionHeader"></h3>
                <div>
                    <?= contentE ?>
                </div>
                <h3 id="f1SubmissionHeader"></h3>
                <div>
                    <?= contentF ?>
                </div>
                <h3 id="j1SubmissionHeader"></h3>
                <div>
                    <iframe frameborder='0' height='55' width='100%' src=<?=contentJ ?>></iframe>
                </div>
                <h3 id="k1SubmissionHeader"></h3>
                <div>
                    <iframe frameborder='0' height='1000' width='100%' src=<?=contentK ?>></iframe>
                </div>
                <h3 id="i1SubmissionHeader"></h3>
                <div>
                    <iframe frameborder='0' height='300' width='100%' src=<?=contentI ?>></iframe>
                </div>
                <h3 id="m1SubmissionHeader"></h3>
                <div>
                    <iframe src=<?=contentM ?> frameborder="0" allowfullscreen="" style="width:100%;
                        height:400px;"></iframe>
                </div>
                <h3 id="g1SubmissionHeader"></h3>
                <div>
                    <?= contentG ?>
                </div>
                <h3 id="h1SubmissionHeader"></h3>
                <div>
                    <?= contentH ?>
                </div>
                <h3 id="l1SubmissionHeader"></h3>
                <div>
                    <?= contentL ?>
                </div>
                <h3 id="n1SubmissionHeader"></h3>
                <div>
                    <?= contentN ?>
                </div>
                <h3 id="o1SubmissionHeader"></h3>
                <div>
                    <?= contentO ?>
                </div>
                <h3 id="p1SubmissionHeader"></h3>
                <div>
                    <?= contentP ?>
                </div>
                <h3 id="q1SubmissionHeader"></h3>
                <div>
                    <?= contentQ ?>
                </div>
            </div>

            <div id="publishUniverseOrRejectBody" class="publishUniverseReject">
                <input type="text" id="emailSubject">
                <input type="hidden" id="responseSheetName" value="<?= responseSheetName ?>">
                <input type="hidden" id="responseRow" value="<?= responseRow ?>">
                <input type="hidden" id="emailSubjectAltenative">
                <input type="hidden" id="emailBodyAltenative">
                <input type="hidden" id="webAppUrl" value="<?= webAppUrl ?>">
                <br><br>
                <textarea id="emailBody"></textarea>
                <div class="containerForButtons">
                    <button id="sendButtonPublish" onclick="sendDataToGsFile('SEND','Publish')">Send</button>
                    <button id="sendButtonUniverse" onclick="sendDataToGsFile('SEND','Universe')">Send</button>
                    <button id="sendButtonReject" onclick="sendDataToGsFile('SEND','Reject')">Send</button>
                    <button id="alternativeButtonPublish" onclick="SeeAlternativeEmail('Publish')">Alternative</button>
                    <button id="alternativeButtonUniverse"
                        onclick="SeeAlternativeEmail('Universe')">Alternative</button>
                    <button id="alternativeButtonReject" onclick="SeeAlternativeEmail('Reject')">Alternative</button>
                    <button id="emailTemplatePublishOriginalButton"
                        onclick="SendInfoToOpenEmailTemplate('B1:C1','E:J','N/A','A18:J33')">Email Template</button>
                    <button id="emailTemplatePublishAlternativeButton"
                        onclick="SendInfoToOpenEmailTemplate('B17:C17','E:J','N/A','A1:J16')">Email Template</button>
                    <button id="emailTemplateUniverseOriginalButton"
                        onclick="SendInfoToOpenEmailTemplate('E1:F1','A:C','H:J','A18:J33')">Email Template</button>
                    <button id="emailTemplateUniverseAlternativeButton"
                        onclick="SendInfoToOpenEmailTemplate('E17:F17','A:C','H:J','A1:J16')">Email Template</button>
                    <button id="emailTemplateRejectOriginalButton"
                        onclick="SendInfoToOpenEmailTemplate('H1:I1','A:F','N/A','A18:J33')">Email Template</button>
                    <button id="emailTemplateRejectAlternativeButton"
                        onclick="SendInfoToOpenEmailTemplate('H17:I17','A:F','N/A','A1:J16')">Email Template</button>
                    <button id="cancelButtonPublish" onclick="sendDataToGsFile('CANCEL','Publish')">Cancel</button>
                    <button id="cancelButtonUniverse" onclick="sendDataToGsFile('CANCEL','Universe')">Cancel</button>
                    <button id="cancelButtonReject" onclick="sendDataToGsFile('CANCEL','Reject')">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            const returnValue = results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
            console.log("getUrlParameter(" + name + "): ", returnValue);
            return returnValue;
        }

        var dataParam = getUrlParameter('data');
        if (dataParam) {
            var data = JSON.parse(dataParam);
            var rowValues = data.rowValues;

            // Fill the pre-defined divs with row data
            for (var i = 0; i < rowValues.length; i++) { // Index 0 is column B. Skip column A because that is the checkbox column.
                var div = document.getElementById(['colB_Data', 'colC_Data', 'colD_Data', 'colE_Data', 'colF_Data'][i]);
                if (div) {
                    div.textContent = rowValues[i];
                }
            }
        }

        function fetchData() {
            const url = new URL(window.location.href);
            const googleScriptUrl = url.searchParams.get('googleScriptUrl');
            if (googleScriptUrl) {
                fetch(googleScriptUrl)
                    .then(response => response.json())
                    .then(data => {
                        if (data && data.b1ToQ1SubmissionHeaders) {
                            const values = data.b1ToQ1SubmissionHeaders;
                            document.getElementById("b1SubmissionHeader").innerHTML = values[0];
                            document.getElementById("c1SubmissionHeader").innerHTML = values[1];
                            document.getElementById("d1SubmissionHeader").innerHTML = values[2];
                            document.getElementById("e1SubmissionHeader").innerHTML = values[3];
                            document.getElementById("f1SubmissionHeader").innerHTML = values[4];
                            document.getElementById("g1SubmissionHeader").innerHTML = values[5];
                            document.getElementById("h1SubmissionHeader").innerHTML = values[6];
                            document.getElementById("i1SubmissionHeader").innerHTML = values[7];
                            document.getElementById("j1SubmissionHeader").innerHTML = values[8];
                            document.getElementById("k1SubmissionHeader").innerHTML = values[9];
                            document.getElementById("l1SubmissionHeader").innerHTML = values[10];
                            document.getElementById("m1SubmissionHeader").innerHTML = values[11];
                            document.getElementById("n1SubmissionHeader").innerHTML = values[12];
                            document.getElementById("o1SubmissionHeader").innerHTML = values[13];
                            document.getElementById("p1SubmissionHeader").innerHTML = values[14];
                            document.getElementById("q1SubmissionHeader").innerHTML = values[15];
                        } else {
                            console.error("B1:Q1 Submission Headers are null or undefined");
                        }

                        if (data && data.b1Value) {
                            document.getElementById("b1Display").innerHTML = data.b1Value;
                        } else {
                            console.error("Test!B1 value is null or undefined");
                        }
                    })
                    .catch(error => {
                        console.error("Error fetching data:", error);
                    });
            }
        }

        fetchData(); // Call fetchData immediately

        function displayData(data) {
            document.getElementById("displayArea").innerHTML = data;
        }

        function getGoogleData() {
            const url = new URL(window.location.href);
            const googleScriptUrl = url.searchParams.get('googleScriptUrl');
            if (googleScriptUrl) {
                fetch(googleScriptUrl)
                    .then(response => response.text())
                    .then(data => displayData(data));
            }
        }

        getGoogleData(); // Call getGoogleData immediately

        function closeWindow() {
            window.close();
        }

        function sendInput() {
            const userInput = document.getElementById('userInput').value;
            const url = new URL(window.location.href);
            const googleScriptUrl = url.searchParams.get('googleScriptUrl');
            if (googleScriptUrl) {
                fetch(googleScriptUrl + "?userInput=" + encodeURIComponent(userInput))
                    .then(() => {
                        console.log("Data Sent", userInput);
                        fetchData(); // Refresh the data after sending input
                        closeWindow(); // Close the window after the fetch request and data refresh
                    })
                    .catch(error => {
                        console.error("Error sending input:", error);
                    });
            }
        }

        const reviewBody = document.getElementById('reviewBody');
        const publishUniverseOrRejectBody = document.getElementById('publishUniverseOrRejectBody');
        const bodyElement = document.getElementById('mainContainer');
        const buttonElement = document.querySelectorAll("button");
        const emailSubject = document.getElementById('emailSubject');
        const emailBody = document.getElementById('emailBody');
        const emailSubjectAlternative = document.getElementById('emailSubjectAltenative');
        const emailBodyAlternative = document.getElementById('emailBodyAltenative');
        const publishUniverseOrReject = document.getElementById('publishUniverseOrReject');
        const sendButtonPublish = document.getElementById('sendButtonPublish');
        const alternativeButtonPublish = document.getElementById('alternativeButtonPublish');
        const emailTemplatePublishOriginalButton = document.getElementById('emailTemplatePublishOriginalButton');
        const emailTemplatePublishAlternativeButton = document.getElementById('emailTemplatePublishAlternativeButton');
        const cancelButtonPublish = document.getElementById('cancelButtonPublish');
        const sendButtonUniverse = document.getElementById('sendButtonUniverse');
        const alternativeButtonUniverse = document.getElementById('alternativeButtonUniverse');
        const emailTemplateUniverseOriginalButton = document.getElementById('emailTemplateUniverseOriginalButton');
        const emailTemplateUniverseAlternativeButton = document.getElementById('emailTemplateUniverseAlternativeButton');
        const cancelButtonUniverse = document.getElementById('cancelButtonUniverse');
        const sendButtonReject = document.getElementById('sendButtonReject');
        const alternativeButtonReject = document.getElementById('alternativeButtonReject');
        const emailTemplateRejectOriginalButton = document.getElementById('emailTemplateRejectOriginalButton');
        const emailTemplateRejectAlternativeButton = document.getElementById('emailTemplateRejectAlternativeButton');
        const cancelButtonReject = document.getElementById('cancelButtonReject');
        const review = document.getElementById('review');
        const publish = document.getElementById('publish');
        const universe = document.getElementById('universe');
        const reject = document.getElementById('reject');
        const root = document.documentElement;
        const navButtonHoverBackgroundColor = getComputedStyle(root).getPropertyValue('--navButtonHoverBackgroundColor');
        const navButtonHoverColor = getComputedStyle(root).getPropertyValue('--navButtonHoverColor');
        const bodyBackgroundColorReview = getComputedStyle(root).getPropertyValue('--bodyBackgroundColorReview');
        const bodyBackgroundColorPublish = getComputedStyle(root).getPropertyValue('--bodyBackgroundColorPublish');
        const bodyBackgroundColorUniverse = getComputedStyle(root).getPropertyValue('--bodyBackgroundColorUniverse');
        const bodyBackgroundColorReject = getComputedStyle(root).getPropertyValue('--bodyBackgroundColorReject');
        const buttonBackgroundColorReview = getComputedStyle(root).getPropertyValue('--buttonBackgroundColorReview');
        const buttonBackgroundColorPublish = getComputedStyle(root).getPropertyValue('--buttonBackgroundColorPublish');
        const buttonBackgroundColorUniverse = getComputedStyle(root).getPropertyValue('--buttonBackgroundColorUniverse');
        const buttonBackgroundColorReject = getComputedStyle(root).getPropertyValue('--buttonBackgroundColorReject');
        const mainContainer = document.getElementById('mainContainer');

        function SetOnMouseOver(reviewPublishUniverseRejectMoveOrDelete) {
            if (reviewPublishUniverseRejectMoveOrDelete == "Review") {
                reviewBody.style.display = 'block';
                publishUniverseOrRejectBody.style.display = 'none';
                bodyElement.style.backgroundColor = bodyBackgroundColorReview;

                review.style.backgroundColor = buttonBackgroundColorReview;
                review.style.color = "#000";
                publish.style.backgroundColor = "#333";
                publish.style.color = "#fff";
                universe.style.backgroundColor = "#333";
                universe.style.color = "#fff";
                reject.style.backgroundColor = "#333";
                reject.style.color = "#fff";
            }
            else if (reviewPublishUniverseRejectMoveOrDelete == "Publish") {
                reviewBody.style.display = 'none';
                publishUniverseOrRejectBody.style.display = 'block';
                bodyElement.style.backgroundColor = bodyBackgroundColorPublish;

                for (let i = 0; i < buttonElement.length; i++) {
                    buttonElement[i].style.backgroundColor = buttonBackgroundColorPublish;
                    buttonElement[i].style.color = "#fff";
                }

                emailSubject.value = "<?= publishEmailSubject ?>";
                emailBody.value = "<?= publishEmailBody ?>";
                alternativeButtonPublish.innerText = "Alternative";

                sendButtonPublish.style.display = 'inline-block';
                alternativeButtonPublish.style.display = 'inline-block';
                emailTemplatePublishOriginalButton.style.display = 'inline-block';
                emailTemplatePublishAlternativeButton.style.display = 'none';
                cancelButtonPublish.style.display = 'inline-block';
                sendButtonUniverse.style.display = 'none';
                alternativeButtonUniverse.style.display = 'none';
                emailTemplateUniverseOriginalButton.style.display = 'none';
                emailTemplateUniverseAlternativeButton.style.display = 'none';
                cancelButtonUniverse.style.display = 'none';
                sendButtonReject.style.display = 'none';
                alternativeButtonReject.style.display = 'none';
                emailTemplateRejectOriginalButton.style.display = 'none';
                emailTemplateRejectAlternativeButton.style.display = 'none';
                cancelButtonReject.style.display = 'none';

                review.style.backgroundColor = "#333";
                review.style.color = "#fff";
                publish.style.backgroundColor = buttonBackgroundColorPublish;
                publish.style.color = "#fff";
                universe.style.backgroundColor = "#333";
                universe.style.color = "#fff";
                reject.style.backgroundColor = "#333";
                reject.style.color = "#fff";
            }
            else if (reviewPublishUniverseRejectMoveOrDelete == "Universe") {
                reviewBody.style.display = 'none';
                publishUniverseOrRejectBody.style.display = 'block';
                bodyElement.style.backgroundColor = bodyBackgroundColorUniverse;

                for (let i = 0; i < buttonElement.length; i++) {
                    buttonElement[i].style.backgroundColor = buttonBackgroundColorUniverse;
                    buttonElement[i].style.color = "#000";
                }

                emailSubject.value = "<?= universeEmailSubject ?>";
                emailBody.value = "<?= universeEmailBody ?>";

                sendButtonPublish.style.display = 'none';
                alternativeButtonPublish.style.display = 'none';
                emailTemplatePublishOriginalButton.style.display = 'none';
                emailTemplatePublishAlternativeButton.style.display = 'none';
                cancelButtonPublish.style.display = 'none';
                sendButtonUniverse.style.display = 'inline-block';
                alternativeButtonUniverse.style.display = 'inline-block';
                emailTemplateUniverseOriginalButton.style.display = 'inline-block';
                emailTemplateUniverseAlternativeButton.style.display = 'none';
                cancelButtonUniverse.style.display = 'inline-block';
                sendButtonReject.style.display = 'none';
                alternativeButtonReject.style.display = 'none';
                emailTemplateRejectOriginalButton.style.display = 'none';
                emailTemplateRejectAlternativeButton.style.display = 'none';
                cancelButtonReject.style.display = 'none';

                review.style.backgroundColor = "#333";
                review.style.color = "#fff";
                publish.style.backgroundColor = "#333";
                publish.style.color = "#fff";
                universe.style.backgroundColor = buttonBackgroundColorUniverse;
                universe.style.color = navButtonHoverColor;
                reject.style.backgroundColor = "#333";
                reject.style.color = "#fff";
            }
            else if (reviewPublishUniverseRejectMoveOrDelete == "Reject") {
                reviewBody.style.display = 'none';
                publishUniverseOrRejectBody.style.display = 'block';
                bodyElement.style.backgroundColor = bodyBackgroundColorReject;

                for (let i = 0; i < buttonElement.length; i++) {
                    buttonElement[i].style.backgroundColor = buttonBackgroundColorReject;
                    buttonElement[i].style.color = "#fff";
                }

                emailSubject.value = "<?= rejectEmailSubject ?>";
                emailBody.value = "<?= rejectEmailBody ?>";

                sendButtonPublish.style.display = 'none';
                alternativeButtonPublish.style.display = 'none';
                emailTemplatePublishOriginalButton.style.display = 'none';
                emailTemplatePublishAlternativeButton.style.display = 'none';
                cancelButtonPublish.style.display = 'none';
                sendButtonUniverse.style.display = 'none';
                alternativeButtonUniverse.style.display = 'none';
                emailTemplateUniverseOriginalButton.style.display = 'none';
                emailTemplateUniverseAlternativeButton.style.display = 'none';
                cancelButtonUniverse.style.display = 'none';
                sendButtonReject.style.display = 'inline-block';
                alternativeButtonReject.style.display = 'inline-block';
                emailTemplateRejectOriginalButton.style.display = 'inline-block';
                emailTemplateRejectAlternativeButton.style.display = 'none';
                cancelButtonReject.style.display = 'inline-block';

                review.style.backgroundColor = "#333";
                review.style.color = "#fff";
                publish.style.backgroundColor = "#333";
                publish.style.color = "#fff";
                universe.style.backgroundColor = "#333";
                universe.style.color = "#fff";
                reject.style.backgroundColor = buttonBackgroundColorReject;
                reject.style.color = "#fff";
            }
            else if (reviewPublishUniverseRejectMoveOrDelete == "Move" || reviewPublishUniverseRejectMoveOrDelete == "Delete") {
                review.style.backgroundColor = "#333";
                review.style.color = "#fff";
                publish.style.backgroundColor = "#333";
                publish.style.color = "#fff";
                universe.style.backgroundColor = "#333";
                universe.style.color = "#fff";
                reject.style.backgroundColor = "#333";
                reject.style.color = "#fff";
            }
        }

        function SetOnMouseEnterBody() {
            if (reviewBody.style.display == 'block') {
                bodyElement.style.backgroundColor = bodyBackgroundColorReview;
            }
            else if (publishUniverseOrRejectBody.style.display == 'block' && sendButtonPublish.style.display == 'inline-block') {
                bodyElement.style.backgroundColor = bodyBackgroundColorPublish;
            }
            else if (publishUniverseOrRejectBody.style.display == 'block' && sendButtonUniverse.style.display == 'inline-block') {
                bodyElement.style.backgroundColor = bodyBackgroundColorUniverse;
            }
            else if (publishUniverseOrRejectBody.style.display == 'block' && sendButtonReject.style.display == 'inline-block') {
                bodyElement.style.backgroundColor = bodyBackgroundColorReject;
            }
            else {
                bodyElement.style.backgroundColor = "#fff";
            }
        }

        function SendInfoToGsFile(sheetName) {
            const url = new URL(window.location.href);
            const googleScriptUrl = url.searchParams.get('googleScriptUrl');
            if (googleScriptUrl) {
                fetch(googleScriptUrl + "?sheetName=" + encodeURIComponent(sheetName))
                    .then(() => {
                        console.log("SheetName Sent", sheetName);
                    });
            }
        }

        function SendInfoForDelete() {
            const url = new URL(window.location.href);
            const googleScriptUrl = url.searchParams.get('googleScriptUrl');
            if (googleScriptUrl) {
                fetch(googleScriptUrl + "?delete=true")
                    .then(() => {
                        console.log("Delete Sent");
                    });
            }
        }

        function sendDataToGsFile(sendOrCancel, publishUniverseOrReject) {
            const emailSubject = document.getElementById('emailSubject').value;
            const emailBody = document.getElementById('emailBody').value;
            const responseSheetName = document.getElementById('responseSheetName').value;
            const responseRow = document.getElementById('responseRow').value;
            const webAppUrl = document.getElementById('webAppUrl').value;
            const url = new URL(window.location.href);
            const googleScriptUrl = url.searchParams.get('googleScriptUrl');

            if (googleScriptUrl) {
                fetch(googleScriptUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams({
                        sendOrCancel: sendOrCancel,
                        publishUniverseOrReject: publishUniverseOrReject,
                        emailSubject: emailSubject,
                        emailBody: emailBody,
                        responseSheetName: responseSheetName,
                        responseRow: responseRow,
                        webAppUrl: webAppUrl
                    })
                })
                    .then(response => response.text())
                    .then(data => {
                        console.log("Data sent:", data);
                        window.close();
                    })
                    .catch(error => {
                        console.error("Error sending data:", error);
                    });
            }
        }

        function SeeAlternativeEmail(publishUniverseOrReject) {
            const emailSubject = document.getElementById('emailSubject');
            const emailBody = document.getElementById('emailBody');
            const emailSubjectAlternative = document.getElementById('emailSubjectAltenative');
            const emailBodyAlternative = document.getElementById('emailBodyAltenative');
            const alternativeButtonPublish = document.getElementById('alternativeButtonPublish');
            const alternativeButtonUniverse = document.getElementById('alternativeButtonUniverse');
            const alternativeButtonReject = document.getElementById('alternativeButtonReject');
            const emailTemplatePublishOriginalButton = document.getElementById('emailTemplatePublishOriginalButton');
            const emailTemplatePublishAlternativeButton = document.getElementById('emailTemplatePublishAlternativeButton');
            const emailTemplateUniverseOriginalButton = document.getElementById('emailTemplateUniverseOriginalButton');
            const emailTemplateUniverseAlternativeButton = document.getElementById('emailTemplateUniverseAlternativeButton');
            const emailTemplateRejectOriginalButton = document.getElementById('emailTemplateRejectOriginalButton');
            const emailTemplateRejectAlternativeButton = document.getElementById('emailTemplateRejectAlternativeButton');

            if (publishUniverseOrReject == 'Publish') {
                if (alternativeButtonPublish.innerText == 'Alternative') {
                    emailSubject.value = emailSubjectAlternative.value;
                    emailBody.value = emailBodyAlternative.value;
                    alternativeButtonPublish.innerText = 'Original';
                    emailTemplatePublishOriginalButton.style.display = 'none';
                    emailTemplatePublishAlternativeButton.style.display = 'inline-block';
                }
                else {
                    emailSubject.value = "<?= publishEmailSubject ?>";
                    emailBody.value = "<?= publishEmailBody ?>";
                    alternativeButtonPublish.innerText = 'Alternative';
                    emailTemplatePublishOriginalButton.style.display = 'inline-block';
                    emailTemplatePublishAlternativeButton.style.display = 'none';
                }
            }
            else if (publishUniverseOrReject == 'Universe') {
                if (alternativeButtonUniverse.innerText == 'Alternative') {
                    emailSubject.value = emailSubjectAlternative.value;
                    emailBody.value = emailBodyAlternative.value;
                    alternativeButtonUniverse.innerText = 'Original';
                    emailTemplateUniverseOriginalButton.style.display = 'none';
                    emailTemplateUniverseAlternativeButton.style.display = 'inline-block';
                }
                else {
                    emailSubject.value = "<?= universeEmailSubject ?>";
                    emailBody.value = "<?= universeEmailBody ?>";
                    alternativeButtonUniverse.innerText = 'Alternative';
                    emailTemplateUniverseOriginalButton.style.display = 'inline-block';
                    emailTemplateUniverseAlternativeButton.style.display = 'none';
                }
            }
            else if (publishUniverseOrReject == 'Reject') {
                if (alternativeButtonReject.innerText == 'Alternative') {
                    emailSubject.value = emailSubjectAlternative.value;
                    emailBody.value = emailBodyAlternative.value;
                    alternativeButtonReject.innerText = 'Original';
                    emailTemplateRejectOriginalButton.style.display = 'none';
                    emailTemplateRejectAlternativeButton.style.display = 'inline-block';
                }
                else {
                    emailSubject.value = "<?= rejectEmailSubject ?>";
                    emailBody.value = "<?= rejectEmailBody ?>";
                    alternativeButtonReject.innerText = 'Alternative';
                    emailTemplateRejectOriginalButton.style.display = 'inline-block';
                    emailTemplateRejectAlternativeButton.style.display = 'none';
                }
            }
        }

        function SendInfoToOpenEmailTemplate(range1, range2, range3, range4) {
            const url = new URL(window.location.href);
            const googleScriptUrl = url.searchParams.get('googleScriptUrl');
            if (googleScriptUrl) {
                fetch(googleScriptUrl + "?range1=" + encodeURIComponent(range1) + "&range2=" + encodeURIComponent(range2) + "&range3=" + encodeURIComponent(range3) + "&range4=" + encodeURIComponent(range4))
                    .then(() => {
                        console.log("Email Template Sent");
                        window.close();
                    });
            }
        }
    </script>
</body>

</html>